import e from"react";function t(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function n(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function s(e){for(var r=1;r<arguments.length;r++){var s=null!=arguments[r]?arguments[r]:{};r%2?n(Object(s),!0).forEach(function(r){t(e,r,s[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}function i(e,t){if(null==e)return{};var r,n,s=function(e,t){if(null==e)return{};var r,n,s={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(s[r]=e[r]);return s}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}class o extends e.Component{constructor(t){super(t),this._ref=e.createRef()}componentDidMount(){l.call(this,null)}componentDidUpdate(e){let t;e.style!==this.props.style&&(Object.keys(e.style).forEach(r=>{t=e.style[r],this.props.style.hasOwnProperty(r)||t.instance.removeCallbackWithKey(r)}),l.call(this,t))}componentWillUnmount(){let e;Object.keys(this.props.style).forEach(t=>{"function"==typeof(e=this.props.style[t]).run&&e.instance.removeCallbackWithKey(t)})}render(){const t=this.props,{animatedProps:r,children:n,forwaredRef:o,style:l,type:c}=t,u=i(t,["animatedProps","children","forwaredRef","style","type"]);return e.createElement(c,s({},u,{style:a(l),ref:e=>{o&&(o.current=e),this._ref.current=e}}),n)}}function l(e){Object.keys(this.props.style).forEach(t=>{"function"==typeof(e=this.props.style[t]).run&&e.instance.addCallbackWithKey(t,e.run(this._ref.current,t))})}function a(e){return Object.keys(e).reduce((t,r)=>("string"==typeof e[r]&&(t[r]=e[r]),t),{})}const c={};var u=new Proxy(o,{get:(t,n)=>c[n]||(c[n]=e.forwardRef((t,s)=>{let{children:l}=t,a=i(t,["children"]);return e.createElement(o,r({forwaredRef:s,type:n},a),l)}))});class f{get length(){return this._keys.length}get config(){return this._config}constructor(e,t){this._callbacks=new Map,this._keys=[],this._values={},this._config=s({initialVelocity:0,friction:26,mass:1,precision:.01,tension:170},t);for(let t in e)this._values[t]={done:!1,toValue:e[t],lastPosition:e[t],lastTime:void 0,lastVelocity:void 0},this._keys.push(t)}removeCallbackWithKey(e){this._callbacks.delete(e)}addCallbackWithKey(e,t){this._callbacks.set(e,t)}updateValue(){for(let[e,t]of this._callbacks)t(this._values)}set(e){for(let t in e)this._values.hasOwnProperty(t)&&this._values[t]!==e[t]&&(this._values[t]=s({},this._values[t],{done:!1,lastVelocity:void 0,toValue:e[t]}))}getValues(e){return this._values[this._keys[e]]}}class p{static getInstance(){return p._instance||(p._instance=new p)}constructor(){t(this,"update",()=>{let e=Date.now();for(let t=0;t<p.QUEUE.length;t++){const r=p.QUEUE[t];let n,s=r.config;for(let t=0;t<r.length;t++){const i=r.getValues(t);if(i.done)continue;let o=i.toValue,l=i.lastPosition,a=s.initialVelocity;n=void 0!==i.lastTime?i.lastTime:e,a=void 0!==i.lastVelocity?i.lastVelocity:s.initialVelocity,e>n+64&&(n=e);let c=Math.floor(e-n);for(let e=0;e<c;++e){l+=1*(a+=1*((-s.tension*(l-o)+-s.friction*a)/s.mass)/1e3)/1e3}let u=Math.abs(a)<=s.precision,f=Math.abs(o-l)<=s.precision;i.lastVelocity=a,i.lastTime=e,u&&f&&(i.value!==o&&(l=o),i.done=!0),i.lastPosition=l,r.updateValue()}}requestAnimationFrame(this.update)}),"function"==typeof requestAnimationFrame&&requestAnimationFrame(this.update)}add(e){return e instanceof f&&p.QUEUE.push(e),this}remove(e){for(let t=0;t<p.QUEUE.length;t++)p.QUEUE[t]===e&&p.QUEUE.splice(t,1);return this}}function h(t,r){const n=e.useRef(null),[s,i]=e.useState(null);return n.current||(n.current=new f(t,r),p.getInstance().add(n.current)),e.useEffect(()=>()=>{p.getInstance().remove(n.current)},[]),[s||n.current,e=>{n.current.set(e),i(n.current)}]}function y(e,t){return{instance:e,run:(e,r)=>-1===r.indexOf("--")?n=>{e.style[r]=t(n)}:n=>{e.style.setProperty(r,t(n))}}}t(p,"QUEUE",[]),t(p,"_instance",null);export{u as Animated,f as Animation,p as AnimationManager,y as interpolate,h as useSpring};